<!DOCTYPE html>
<html lang="en">
<!-- https://github.com/futurepress/epub.js/blob/master/examples/input.html -->
<!-- https://github.com/futurepress/epub.js/blob/master/examples/themes.html -->
<!-- Git commit: Strg + K -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EPUB.js Input Example</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
    <script src="https://github.com/futurepress/epub.js/releases/download/v0.3.88/epub.min.js"></script>

    <!--<link re<l="stylesheet" type="text/css" href="epub-example-stylesheet.css">-->

    </head>
    <body>
    <div id="title"><input type="file" id="input"></div>
    <div id="viewer" class="spreads"></div>
    <a id="prev" href="#prev" class="arrow">‹</a>
    <a id="next" href="#next" class="arrow">›</a>
    <a id="g" href="#g" class="arrow">b</a>
    <a id="k" href="#k" class="arrow">s</a>

    <script>
        let book = ePub();
        let rendition;
        let fontPercent = 100;

        let inputElement = document.getElementById("input");

        inputElement.addEventListener('change', function (e) {
            let file = e.target.files[0];
            if (window.FileReader) {
                let reader = new FileReader();
                reader.onload = openBook;
                reader.readAsArrayBuffer(file);
            }
        });

        function openBook(e){
            let bookData = e.target.result;
            let title = document.getElementById("title");
            let next = document.getElementById("next");
            let prev = document.getElementById("prev");
            let g = document.getElementById("g");
            let k = document.getElementById("k");

            book.open(bookData, "binary");

            rendition = book.renderTo("viewer", {
                width: "100%",
                height: 600
            });

            rendition.display();

            let keyListener = function(e){

                // Left Key
                if ((e.keyCode || e.which) == 37) {
                    rendition.prev();

                }

                // Right Key
                if ((e.keyCode || e.which) == 39) {
                    rendition.next();
                }

                // UP Key
                if ((e.keyCode || e.which) == 38) {
                    fontPercent = fontPercent + 10;
                    rendition.themes.fontSize(fontPercent + "%");
                }

                // DOWN Key
                if ((e.keyCode || e.which) == 40) {
                    fontPercent = fontPercent - 10;
                    rendition.themes.fontSize(fontPercent + "%");
                }

            };

            //rendition.on("keyup", keyListener);
            rendition.on("relocated", function(location){
                console.log(location);
            });

            next.addEventListener("click", function(e){
                rendition.next();
                e.preventDefault();
            }, false);

            prev.addEventListener("click", function(e){
                rendition.prev();
                e.preventDefault();
            }, false);

            g.addEventListener("click", function(e){
                fontPercent = fontPercent + 10;
                rendition.themes.fontSize(fontPercent + "%");
                e.preventDefault();
            }, false);

            k.addEventListener("click", function(e){
                fontPercent = fontPercent - 10;
                rendition.themes.fontSize(fontPercent + "%");
                e.preventDefault();
            }, false);

            document.addEventListener("keyup", keyListener, false);
        }
    </script>
</body>
</html>